class Solution {
public:
    int trap(vector<int>& height) {
        
        int length = height.size();
        if (length == 0 || length < 3) return 0;

        int left = 0;
        int right = length - 1;
        int left_max = 0;
        int right_max = 0;
        int water = 0;

        while (left < right) {
            if (height[left] <= height[right]) {
                if (height[left] >= left_max) {
                    left_max = height[left];
                }
                else water += left_max - height[left];
                left++;
            }
            else {
                if (height[right] >= right_max) {
                    right_max = height[right];
                }
                else water += right_max - height[right];
                right--;
            }
        }

        return water;
    }
};

/*
height = [0,1,0,2,1,0,1,3,2,1,2,1]
index     0 1 2 3 4 5 6 7 8 9 10 11

=======================================

Step | L  | R  | h[L] | h[R] | L_max | R_max | water | Calculation
-----|----|----|------|------|-------|-------|-------|------------------
init | 0  | 11 |  0   |  1   |   0   |   0   |   0   | 
-----|----|----|------|------|-------|-------|-------|------------------
  1  | 0  | 11 |  0   |  1   |   0   |   0   |   0   | h[0]<h[11] → process L
     |    |    |      |      |       |       |       | 0>=0? L_max=0
     |    |    |      |      |       |       |       | L++
-----|----|----|------|------|-------|-------|-------|------------------
  2  | 1  | 11 |  1   |  1   |   0   |   0   |   0   | h[1]=h[11] → process L
     |    |    |      |      |       |       |       | 1>0? L_max=1
     |    |    |      |      |   1   |       |       | L++
-----|----|----|------|------|-------|-------|-------|------------------
  3  | 2  | 11 |  0   |  1   |   1   |   0   |   0   | h[2]<h[11] → process L
     |    |    |      |      |       |       |       | 0<1? water+=1-0=1
     |    |    |      |      |       |       |   1   | L++
-----|----|----|------|------|-------|-------|-------|------------------
  4  | 3  | 11 |  2   |  1   |   1   |   0   |   1   | h[3]>h[11] → process R
     |    |    |      |      |       |       |       | 1>0? R_max=1
     |    |    |      |      |       |   1   |       | R--
-----|----|----|------|------|-------|-------|-------|------------------
  5  | 3  | 10 |  2   |  2   |   1   |   1   |   1   | h[3]=h[10] → process L
     |    |    |      |      |       |       |       | 2>1? L_max=2
     |    |    |      |      |   2   |       |       | L++
-----|----|----|------|------|-------|-------|-------|------------------
  6  | 4  | 10 |  1   |  2   |   2   |   1   |   1   | h[4]<h[10] → process L
     |    |    |      |      |       |       |       | 1<2? water+=2-1=1
     |    |    |      |      |       |       |   2   | L++
-----|----|----|------|------|-------|-------|-------|------------------
  7  | 5  | 10 |  0   |  2   |   2   |   1   |   2   | h[5]<h[10] → process L
     |    |    |      |      |       |       |       | 0<2? water+=2-0=2
     |    |    |      |      |       |       |   4   | L++
-----|----|----|------|------|-------|-------|-------|------------------
  8  | 6  | 10 |  1   |  2   |   2   |   1   |   4   | h[6]<h[10] → process L
     |    |    |      |      |       |       |       | 1<2? water+=2-1=1
     |    |    |      |      |       |       |   5   | L++
-----|----|----|------|------|-------|-------|-------|------------------
  9  | 7  | 10 |  3   |  2   |   2   |   1   |   5   | h[7]>h[10] → process R
     |    |    |      |      |       |       |       | 2>1? R_max=2
     |    |    |      |      |       |   2   |       | R--
-----|----|----|------|------|-------|-------|-------|------------------
 10  | 7  | 9  |  3   |  1   |   2   |   2   |   5   | h[7]>h[9] → process R
     |    |    |      |      |       |       |       | 1<2? water+=2-1=1
     |    |    |      |      |       |       |   6   | R--
-----|----|----|------|------|-------|-------|-------|------------------
 11  | 7  | 8  |  3   |  2   |   2   |   2   |   6   | h[7]>h[8] → process R
     |    |    |      |      |       |       |       | 2=2? R_max=2
     |    |    |      |      |       |       |       | R--
-----|----|----|------|------|-------|-------|-------|------------------
 12  | 7  | 7  |      |      |       |       |   6   | L=R, terminate!

 =========================================

Index:  0  1  2  3  4  5  6  7  8  9  10 11
Height: 0  1  0  2  1  0  1  3  2  1  2  1

           3
       2   3  2
   1   2   3  2  2
0  1   2   3  2  2  1

Water trapped at each position:
Index 2: 1 unit (step 3)
Index 4: 1 unit (step 6)
Index 5: 2 units (step 7)
Index 6: 1 unit (step 8)
Index 9: 1 unit (step 10)
-------
Total: 6 units
*/